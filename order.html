<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order – Trinetra Bhojanalaya</title>

    <link rel="stylesheet" href="assets/style.css">

    <script src="assets/cart.js"></script>
    <script src="assets/gps.js"></script>
    <script src="assets/delivery.js"></script>
    <script src="assets/firebase.js"></script>
</head>

<body>

<header class="navbar">
    <div class="nav-left">
        <img src="images/logo.jpg" class="logo">
        <span class="brand">Order Now</span>
    </div>
</header>

<section class="order-box">

    <h1>Your Order</h1>

    <div id="cartSummary" class="cart-summary"></div>

    <h1>Customer Details</h1>

    <label>Your Name</label>
    <input id="custName" type="text" placeholder="Enter your name">

    <label>Order Type</label>
    <select id="orderType" onchange="toggleAddress()">
        <option value="delivery">Delivery</option>
        <option value="takeaway">Takeaway</option>
    </select>

    <div id="addressBox">
        <label>Delivery Address</label>
        <textarea id="deliveryAddress" placeholder="Enter complete delivery address"></textarea>
    </div>

    <button id="gpsBtn" class="btn-secondary" onclick="useGPS()">Use My Current Location</button>
    <p id="gpsStatus" class="gps-status"></p>
    <p id="deliveryNote" class="delivery-note"></p>

    <button class="btn-primary" onclick="sendToWhatsApp()">Place Order</button>

</section>

<script>
/* RENDER CART */
let cart = getSavedCart();
let box = document.getElementById("cartSummary");

if (cart.length === 0) {
    box.innerHTML = "<p>Your cart is empty.</p>";
} else {
    let html = "<ul>";
    let total = 0;

    cart.forEach(i => {
        html += `<li>${i.name} x${i.qty} — ₹${i.qty * i.price}</li>`;
        total += i.qty * i.price;
    });

    html += `</ul><h3>Total: ₹${total}</h3>`;
    box.innerHTML = html;
}

/* DELIVERY TOGGLE */
window.toggleAddress = function () {
    let type = document.getElementById("orderType").value;
    document.getElementById("addressBox").style.display =
        type === "delivery" ? "block" : "none";
    document.getElementById("gpsBtn").style.display =
        type === "delivery" ? "block" : "none";
};
toggleAddress();
</script>

</body>
</html>
